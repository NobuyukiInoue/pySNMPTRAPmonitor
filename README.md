# pySNMPTRAPmonitor

Monitor and Dump SNMP TRAP by Python3


## Requirements

Python 3.5 or later.

This program uses UDP port 162.


### Supported OS

* MS-Windows
* macOS
* Linux


### Supported SNMP version

* SNMP version 1
* SNMP version 2c
* SNMP version 3


## How to execute pySNMPTRAPmonitor

```
python snmptrapm.py [timeout(s)] [testmode]
```


## Execution Example

```
PS D:\pySNMPTRAPmonitor> python pysnmptrapm.py
recvfrom() timeout has been set to 60 seconds.
------------------------------------------------------------
Date: 2020-03-18 23:20:17
From: 10.1.1.254:59111
------------------------------------------------------------
0000: 003081          Sequence           48(0x30)
                      size:              1(0x01)

0003: 020101          SNMP verision:     2c(0x01)
0006: 04067075626c6963
                      community:         public(0x7075626c6963)
000e: a78195          data
                      size:              1(0x1)
0011: 02012e          request-id:        46(0x2e)
0014: 020100          error-status:      0(0x0)
0017: 020100          error-index:       0(0x0)
001a: 308189          variable-bindings:
                                         type: Sequence(0x30)
                                         size: 1(0x1)
001f: 06082b06010201010300
                      Obj:               iso.6.1.2.1.1.3.0
                                         (0x2b06010201010300)
0029: 430304c723
                      TimeTicks:         313123(0x04c723)
0030: 060a2b060106030101040100
                      Obj:               iso.6.1.6.3.1.1.4.1.0
                                         (0x2b060106030101040100)
003c: 06092b0601060301010503
                      OBJECT IDENTIFIER: iso.6.1.6.3.1.1.5.3(0x2b0601060301010503)
0049: 060b2b0601020102020101ce7d
                      Obj:               iso.6.1.2.1.2.2.1.1.10109
                                         (0x2b0601020102020101ce7d)
0056: 0202277d
                      INTEGER:           10109(0x277d)
005c: 060b2b0601020102020102ce7d
                      Obj:               iso.6.1.2.1.2.2.1.2.10109
                                         (0x2b0601020102020102ce7d)
0069: 04124769676162697445746865726e6574302f39
                      OCTET STRING:      GigabitEthernet0/9(0x4769676162697445746865726e6574302f39)
007f: 060b2b0601020102020103ce7d
                      Obj:               iso.6.1.2.1.2.2.1.3.10109
                                         (0x2b0601020102020103ce7d)
008c: 020106
                      INTEGER:           6(0x06)
0091: 060d2b06010401090202010114ce7d
                      Obj:               iso.6.1.4.1.9.2.2.1.1.20.10109
                                         (0x2b06010401090202010114ce7d)
00a0: 0404646f776e
                      OCTET STRING:      down(0x646f776e)
------------------------------------------------------------
End of SNMP trap reception.

------------------------------------------------------------
Date: 2020-03-18 23:20:18
From: 10.1.1.254:59111
------------------------------------------------------------
0000: 003081          Sequence           48(0x30)
                      size:              1(0x01)

0003: 020101          SNMP verision:     2c(0x01)
0006: 04067075626c6963
                      community:         public(0x7075626c6963)
000e: a781a6          data
                      size:              1(0x1)
0011: 020130          request-id:        48(0x30)
0014: 020100          error-status:      0(0x0)
0017: 020100          error-index:       0(0x0)
001a: 30819a          variable-bindings:
                                         type: Sequence(0x30)
                                         size: 1(0x1)
001f: 06082b06010201010300
                      Obj:               iso.6.1.2.1.1.3.0
                                         (0x2b06010201010300)
0029: 430304c79b
                      TimeTicks:         313243(0x04c79b)
0030: 060a2b060106030101040100
                      Obj:               iso.6.1.6.3.1.1.4.1.0
                                         (0x2b060106030101040100)
003c: 06092b0601060301010503
                      OBJECT IDENTIFIER: iso.6.1.6.3.1.1.5.3(0x2b0601060301010503)
0049: 060b2b0601020102020101ce7c
                      Obj:               iso.6.1.2.1.2.2.1.1.10108
                                         (0x2b0601020102020101ce7c)
0056: 0202277c
                      INTEGER:           10108(0x277c)
005c: 060b2b0601020102020102ce7c
                      Obj:               iso.6.1.2.1.2.2.1.2.10108
                                         (0x2b0601020102020102ce7c)
0069: 04124769676162697445746865726e6574302f38
                      OCTET STRING:      GigabitEthernet0/8(0x4769676162697445746865726e6574302f38)
007f: 060b2b0601020102020103ce7c
                      Obj:               iso.6.1.2.1.2.2.1.3.10108
                                         (0x2b0601020102020103ce7c)
008c: 020106
                      INTEGER:           6(0x06)
0091: 060d2b06010401090202010114ce7c
                      Obj:               iso.6.1.4.1.9.2.2.1.1.20.10108
                                         (0x2b06010401090202010114ce7c)
00a0: 041561646d696e6973747261746976656c7920646f776e
                      OCTET STRING:      administratively down(0x61646d696e6973747261746976656c7920646f776e)
------------------------------------------------------------
End of SNMP trap reception.

------------------------------------------------------------
Date: 2020-03-18 23:20:32
From: 10.1.1.254:59111
------------------------------------------------------------
0000: 3055            Sequence           48(0x30)
                      size:              85(0x55)

0002: 020101          SNMP verision:     2c(0x01)
0005: 04067075626c6963
                      community:         public(0x7075626c6963)
000d: a748            data
                      size:              72(0x48)
000f: 020132          request-id:        50(0x32)
0012: 020100          error-status:      0(0x0)
0015: 020100          error-index:       0(0x0)
0018: 303d            variable-bindings:
                                         type: Sequence(0x30)
                                         size: 61(0x3d)
001c: 06082b06010201010300
                      Obj:               iso.6.1.2.1.1.3.0
                                         (0x2b06010201010300)
0026: 430304cd0a
                      TimeTicks:         314634(0x04cd0a)
002d: 060a2b060106030101040100
                      Obj:               iso.6.1.6.3.1.1.4.1.0
                                         (0x2b060106030101040100)
0039: 06092b060102012f020001
                      OBJECT IDENTIFIER: iso.6.1.2.1.47.2.0.1(0x2b060102012f020001)
0046: 060a2b060102012f01040100
                      Obj:               iso.6.1.2.1.47.1.4.1.0
                                         (0x2b060102012f01040100)
0052: 430304cd0a
                      TimeTicks:         314634(0x04cd0a)
------------------------------------------------------------
End of SNMP trap reception.

------------------------------------------------------------
Date: 2020-03-18 23:20:35
From: 10.1.1.254:59111
------------------------------------------------------------
0000: 003081          Sequence           48(0x30)
                      size:              1(0x01)

0003: 020101          SNMP verision:     2c(0x01)
0006: 04067075626c6963
                      community:         public(0x7075626c6963)
000e: a78193          data
                      size:              1(0x1)
0011: 020134          request-id:        52(0x34)
0014: 020100          error-status:      0(0x0)
0017: 020100          error-index:       0(0x0)
001a: 308187          variable-bindings:
                                         type: Sequence(0x30)
                                         size: 1(0x1)
001f: 06082b06010201010300
                      Obj:               iso.6.1.2.1.1.3.0
                                         (0x2b06010201010300)
0029: 430304ce34
                      TimeTicks:         314932(0x04ce34)
0030: 060a2b060106030101040100
                      Obj:               iso.6.1.6.3.1.1.4.1.0
                                         (0x2b060106030101040100)
003c: 06092b0601060301010504
                      OBJECT IDENTIFIER: iso.6.1.6.3.1.1.5.4(0x2b0601060301010504)
0049: 060b2b0601020102020101ce7c
                      Obj:               iso.6.1.2.1.2.2.1.1.10108
                                         (0x2b0601020102020101ce7c)
0056: 0202277c
                      INTEGER:           10108(0x277c)
005c: 060b2b0601020102020102ce7c
                      Obj:               iso.6.1.2.1.2.2.1.2.10108
                                         (0x2b0601020102020102ce7c)
0069: 04124769676162697445746865726e6574302f38
                      OCTET STRING:      GigabitEthernet0/8(0x4769676162697445746865726e6574302f38)
007f: 060b2b0601020102020103ce7c
                      Obj:               iso.6.1.2.1.2.2.1.3.10108
                                         (0x2b0601020102020103ce7c)
008c: 020106
                      INTEGER:           6(0x06)
0091: 060d2b06010401090202010114ce7c
                      Obj:               iso.6.1.4.1.9.2.2.1.1.20.10108
                                         (0x2b06010401090202010114ce7c)
00a0: 04027570
                      OCTET STRING:      up(0x7570)
------------------------------------------------------------
End of SNMP trap reception.

------------------------------------------------------------
Date: 2020-03-18 23:20:35
From: 10.1.1.254:59111
------------------------------------------------------------
0000: 003081          Sequence           48(0x30)
                      size:              1(0x01)

0003: 020101          SNMP verision:     2c(0x01)
0006: 04067075626c6963
                      community:         public(0x7075626c6963)
000e: a78193          data
                      size:              1(0x1)
0011: 020136          request-id:        54(0x36)
0014: 020100          error-status:      0(0x0)
0017: 020100          error-index:       0(0x0)
001a: 308187          variable-bindings:
                                         type: Sequence(0x30)
                                         size: 1(0x1)
001f: 06082b06010201010300
                      Obj:               iso.6.1.2.1.1.3.0
                                         (0x2b06010201010300)
0029: 430304ce34
                      TimeTicks:         314932(0x04ce34)
0030: 060a2b060106030101040100
                      Obj:               iso.6.1.6.3.1.1.4.1.0
                                         (0x2b060106030101040100)
003c: 06092b0601060301010504
                      OBJECT IDENTIFIER: iso.6.1.6.3.1.1.5.4(0x2b0601060301010504)
0049: 060b2b0601020102020101ce7d
                      Obj:               iso.6.1.2.1.2.2.1.1.10109
                                         (0x2b0601020102020101ce7d)
0056: 0202277d
                      INTEGER:           10109(0x277d)
005c: 060b2b0601020102020102ce7d
                      Obj:               iso.6.1.2.1.2.2.1.2.10109
                                         (0x2b0601020102020102ce7d)
0069: 04124769676162697445746865726e6574302f39
                      OCTET STRING:      GigabitEthernet0/9(0x4769676162697445746865726e6574302f39)
007f: 060b2b0601020102020103ce7d
                      Obj:               iso.6.1.2.1.2.2.1.3.10109
                                         (0x2b0601020102020103ce7d)
008c: 020106
                      INTEGER:           6(0x06)
0091: 060d2b06010401090202010114ce7d
                      Obj:               iso.6.1.4.1.9.2.2.1.1.20.10109
                                         (0x2b06010401090202010114ce7d)
00a0: 04027570
                      OCTET STRING:      up(0x7570)
------------------------------------------------------------
End of SNMP trap reception.

------------------------------------------------------------
Date: 2020-03-18 23:20:37
From: 10.1.1.254:59111
------------------------------------------------------------
0000: 3055            Sequence           48(0x30)
                      size:              85(0x55)

0002: 020101          SNMP verision:     2c(0x01)
0005: 04067075626c6963
                      community:         public(0x7075626c6963)
000d: a748            data
                      size:              72(0x48)
000f: 020138          request-id:        56(0x38)
0012: 020100          error-status:      0(0x0)
0015: 020100          error-index:       0(0x0)
0018: 303d            variable-bindings:
                                         type: Sequence(0x30)
                                         size: 61(0x3d)
001c: 06082b06010201010300
                      Obj:               iso.6.1.2.1.1.3.0
                                         (0x2b06010201010300)
0026: 430304cefe
                      TimeTicks:         315134(0x04cefe)
002d: 060a2b060106030101040100
                      Obj:               iso.6.1.6.3.1.1.4.1.0
                                         (0x2b060106030101040100)
0039: 06092b060102012f020001
                      OBJECT IDENTIFIER: iso.6.1.2.1.47.2.0.1(0x2b060102012f020001)
0046: 060a2b060102012f01040100
                      Obj:               iso.6.1.2.1.47.1.4.1.0
                                         (0x2b060102012f01040100)
0052: 430304cd0a
                      TimeTicks:         314634(0x04cd0a)
------------------------------------------------------------
End of SNMP trap reception.

recvfrom() was timed out.  (60 second)
PS D:\pySNMPTRAPmonitor>
```
